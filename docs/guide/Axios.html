<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>
      axios 封装 | VIPTV 工作室
    </title>
    <meta name="description" content="前端-后端-小程序-插件">
    <link rel="stylesheet" href="/assets/style.abb47a77.css">
    <link rel="modulepreload" href="/assets/Home.db8c1afd.js">
    <link rel="modulepreload" href="/assets/app.6008987c.js">
    <link rel="modulepreload" href="/assets/guide_axios.md.3217e90e.lean.js">
    <link rel="modulepreload" href="/assets/app.6008987c.js">
    <link rel="icon" type="image/svg+xml" href="/logo.png">
    
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-bf1fd106><div class="sidebar-button" data-v-bf1fd106><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="VIPTV 工作室, back to home" data-v-bf1fd106 data-v-4c226fdc><img class="logo" src="/logo.png" alt="Logo" data-v-4c226fdc> VIPTV 工作室</a><div class="flex-grow" data-v-bf1fd106></div><div class="nav" data-v-bf1fd106><nav class="nav-links" data-v-bf1fd106 data-v-18e47379><!--[--><div class="item" data-v-18e47379><div class="nav-link" data-v-18e47379 data-v-3cf0180d><a class="item active" href="/guide/" data-v-3cf0180d>指引 <!----></a></div></div><div class="item" data-v-18e47379><div class="nav-link" data-v-18e47379 data-v-3cf0180d><a class="item" href="/about/" data-v-3cf0180d>我们 <!----></a></div></div><div class="item" data-v-18e47379><div class="nav-dropdown-link" data-v-18e47379 data-v-34878268><button class="button" data-v-34878268><span class="button-text" data-v-34878268>相关链接</span><span class="right button-arrow" data-v-34878268></span></button><ul class="dialog" data-v-34878268><!--[--><li class="dialog-item" data-v-34878268><div class="nav-dropdown-link-item" data-v-34878268 data-v-3daac2f6><a class="item isExternal" href="https://github.com/viptvx/viptvx.github.io/discussions" target="_blank" rel="noopener noreferrer" data-v-3daac2f6><span class="arrow" data-v-3daac2f6></span><span class="text" data-v-3daac2f6>VIPTV 社区</span><span class="icon" data-v-3daac2f6><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-3daac2f6><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-18e47379><div class="nav-dropdown-link" data-v-18e47379 data-v-34878268><button class="button" data-v-34878268><span class="button-text" data-v-34878268>切换镜像</span><span class="right button-arrow" data-v-34878268></span></button><ul class="dialog" data-v-34878268><!--[--><li class="dialog-item" data-v-34878268><div class="nav-dropdown-link-item" data-v-34878268 data-v-3daac2f6><a class="item isExternal" href="https://viptv.gitee.io/" target="_blank" rel="noopener noreferrer" data-v-3daac2f6><span class="arrow" data-v-3daac2f6></span><span class="text" data-v-3daac2f6>国内站</span><span class="icon" data-v-3daac2f6><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-3daac2f6><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-34878268><div class="nav-dropdown-link-item" data-v-34878268 data-v-3daac2f6><a class="item isExternal" href="https://viptvx.github.io/" target="_blank" rel="noopener noreferrer" data-v-3daac2f6><span class="arrow" data-v-3daac2f6></span><span class="text" data-v-3daac2f6>国际站</span><span class="icon" data-v-3daac2f6><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-3daac2f6><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><!--]--></ul></div></div><!--]--><!----><!----></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-1cb74c72><nav class="nav-links nav" data-v-1cb74c72 data-v-18e47379><!--[--><div class="item" data-v-18e47379><div class="nav-link" data-v-18e47379 data-v-3cf0180d><a class="item active" href="/guide/" data-v-3cf0180d>指引 <!----></a></div></div><div class="item" data-v-18e47379><div class="nav-link" data-v-18e47379 data-v-3cf0180d><a class="item" href="/about/" data-v-3cf0180d>我们 <!----></a></div></div><div class="item" data-v-18e47379><div class="nav-dropdown-link" data-v-18e47379 data-v-34878268><button class="button" data-v-34878268><span class="button-text" data-v-34878268>相关链接</span><span class="right button-arrow" data-v-34878268></span></button><ul class="dialog" data-v-34878268><!--[--><li class="dialog-item" data-v-34878268><div class="nav-dropdown-link-item" data-v-34878268 data-v-3daac2f6><a class="item isExternal" href="https://github.com/viptvx/viptvx.github.io/discussions" target="_blank" rel="noopener noreferrer" data-v-3daac2f6><span class="arrow" data-v-3daac2f6></span><span class="text" data-v-3daac2f6>VIPTV 社区</span><span class="icon" data-v-3daac2f6><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-3daac2f6><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-18e47379><div class="nav-dropdown-link" data-v-18e47379 data-v-34878268><button class="button" data-v-34878268><span class="button-text" data-v-34878268>切换镜像</span><span class="right button-arrow" data-v-34878268></span></button><ul class="dialog" data-v-34878268><!--[--><li class="dialog-item" data-v-34878268><div class="nav-dropdown-link-item" data-v-34878268 data-v-3daac2f6><a class="item isExternal" href="https://viptv.gitee.io/" target="_blank" rel="noopener noreferrer" data-v-3daac2f6><span class="arrow" data-v-3daac2f6></span><span class="text" data-v-3daac2f6>国内站</span><span class="icon" data-v-3daac2f6><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-3daac2f6><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-34878268><div class="nav-dropdown-link-item" data-v-34878268 data-v-3daac2f6><a class="item isExternal" href="https://viptvx.github.io/" target="_blank" rel="noopener noreferrer" data-v-3daac2f6><span class="arrow" data-v-3daac2f6></span><span class="text" data-v-3daac2f6>国际站</span><span class="icon" data-v-3daac2f6><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-3daac2f6><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><!--]--></ul></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-1cb74c72><!--[--><li class="sidebar-link"><p class="sidebar-link-item">基础</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/index">介绍</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/install">安装</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/tools">工具</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">高阶</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/plays">播放组件</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/jiexi">解析封装</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/phpdl">PHP代理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/css">CSS语法</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">接口</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/tv">电视</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/live">直播</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/movie">影视</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/video">视频</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/music">音乐</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/book">小说</a><!----></li></ul></li><!--]--></ul><!--[--><!--[--><div class="sponsors"><a href="http://viptv.gitee.io/dev" target="_blank" rel="VIPTV -云视听【国内镜像站】"><span>VIPTV -云视听【国内镜像站】</span></a><a href="http://viptv.gitee.io/dev" target="_blank" rel="noopener" aria-label="sponsor-img"><img src="/bank.png" alt="VIPTV- 云视听【国内镜像】"></a><a href="http://viptv.gitee.io/mob" target="_blank" rel="noopener" aria-label="sponsor-img"><img src="/bank.png" alt="VIPTV- 云视听【国内镜像】"></a></div><!--]--><!--]--></aside><!-- TODO: make this button accessible --><div class="sidebar-mask"></div><main class="page" data-v-7c281d53><div class="container" data-v-7c281d53><!--[--><!--]--><div class="content" data-v-7c281d53><div data-v-7c281d53><h1 id="axios-封装"><a class="header-anchor" href="#axios-封装" aria-hidden="true">#</a> axios 封装</h1><h2 id="本人精简封装的-axios-js"><a class="header-anchor" href="#本人精简封装的-axios-js" aria-hidden="true">#</a> 本人精简封装的 axios.js</h2><div class="language-js"><pre><code><span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Axios <span class="token keyword">from</span> <span class="token string">&#39;axios&#39;</span>
<span class="token keyword">import</span> cheerio <span class="token keyword">from</span> <span class="token string">&#39;cheerio&#39;</span>
Axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>post<span class="token punctuation">[</span><span class="token string">&#39;Content-Type&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;text/plain; charset=utf-8&#39;</span>
<span class="token keyword">const</span> isEnv <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&#39;production&#39;</span>
<span class="token keyword">const</span> <span class="token function-variable function">isMob</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(iPhone|iPod|Android|ios|iPad)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> req <span class="token operator">=</span> Axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  timeout<span class="token operator">:</span> <span class="token number">15000</span><span class="token punctuation">,</span>
  headers<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&#39;Content-Type&#39;</span><span class="token operator">:</span> <span class="token string">&#39;text/plain;application/x-www-form-urlencoded;charset=UTF-8&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  withCredentials<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  credientials<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  emulateJSON<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

req<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> config
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
req<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> proxy <span class="token operator">=</span> <span class="token string">&#39;https://bird.ioliu.cn/v1/?url=&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> _storage <span class="token operator">=</span> window<span class="token punctuation">.</span>localStorage
<span class="token keyword">const</span> storage <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_storage<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> _storage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">?</span>
        Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">?</span>
        <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>_storage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span>
        _storage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">:</span>
        data
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_storage<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _storage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> val<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">clear</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_storage<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _storage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
  proxy<span class="token punctuation">,</span>
  isMob<span class="token punctuation">,</span>
  isEnv<span class="token punctuation">,</span>
  req<span class="token punctuation">,</span>
  storage<span class="token punctuation">,</span>
  cheerio
<span class="token punctuation">}</span>
</code></pre></div><h2 id="大神封装-axiostool-js-留存参考"><a class="header-anchor" href="#大神封装-axiostool-js-留存参考" aria-hidden="true">#</a> 大神封装 axiosTool.js,留存参考</h2><div class="language-js"><pre><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&#39;axios&#39;</span>
<span class="token comment">//取消请求</span>
<span class="token keyword">let</span> CancelToken <span class="token operator">=</span> axios<span class="token punctuation">.</span>CancelToken
<span class="token comment">//设置默认请求头，如果不需要可以取消这一步</span>
axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&#39;X-Requested-With&#39;</span><span class="token operator">:</span> <span class="token string">&#39;XMLHttpRequest&#39;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 请求超时的时间限制</span>
axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">20000</span>
<span class="token comment">// 开始设置请求 发起的拦截处理</span>
<span class="token comment">// config 代表发起请求的参数的实体</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 得到参数中的 requestName 字段，用于决定下次发起请求，取消对应的 相同字段的请求</span>
    <span class="token comment">// 如果没有 requestName 就默认添加一个 不同的时间戳</span>
    <span class="token keyword">let</span> requestName
    <span class="token keyword">if</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>method <span class="token operator">===</span> <span class="token string">&#39;post&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>data <span class="token operator">&amp;&amp;</span> config<span class="token punctuation">.</span>data<span class="token punctuation">.</span>requestName<span class="token punctuation">)</span><span class="token punctuation">{</span>
            requestName <span class="token operator">=</span> config<span class="token punctuation">.</span>data<span class="token punctuation">.</span>requestName
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            requestName <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>params <span class="token operator">&amp;&amp;</span> config<span class="token punctuation">.</span>params<span class="token punctuation">.</span>requestName<span class="token punctuation">)</span><span class="token punctuation">{</span>
            requestName <span class="token operator">=</span> config<span class="token punctuation">.</span>params<span class="token punctuation">.</span>requestName
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            requestName <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 判断，如果这里拿到的参数中的 requestName 在上一次请求中已经存在，就取消上一次的请求</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>requestName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>axios<span class="token punctuation">[</span>requestName<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> axios<span class="token punctuation">[</span>requestName<span class="token punctuation">]</span><span class="token punctuation">.</span>cancel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            axios<span class="token punctuation">[</span>requestName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        config<span class="token punctuation">.</span>cancelToken <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CancelToken</span><span class="token punctuation">(</span><span class="token parameter">c</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            axios<span class="token punctuation">[</span>requestName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
            axios<span class="token punctuation">[</span>requestName<span class="token punctuation">]</span><span class="token punctuation">.</span>cancel <span class="token operator">=</span> c
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> config
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 请求到结果的拦截处理</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 返回请求正确的结果</span>
    <span class="token keyword">return</span> config
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 错误的请求结果处理，这里的代码根据后台的状态码来决定错误的输出信息</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token number">400</span><span class="token operator">:</span>
                error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;错误请求&#39;</span>
                <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">401</span><span class="token operator">:</span>
                error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;未授权，请重新登录&#39;</span>
                <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">403</span><span class="token operator">:</span>
                error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;拒绝访问&#39;</span>
                <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">404</span><span class="token operator">:</span>
                error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;请求错误,未找到该资源&#39;</span>
                <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">405</span><span class="token operator">:</span>
                error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;请求方法未允许&#39;</span>
                <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">408</span><span class="token operator">:</span>
                error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;请求超时&#39;</span>
                <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">500</span><span class="token operator">:</span>
                error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;服务器端出错&#39;</span>
                <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">501</span><span class="token operator">:</span>
                error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;网络未实现&#39;</span>
                <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">502</span><span class="token operator">:</span>
                error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;网络错误&#39;</span>
                <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">503</span><span class="token operator">:</span>
                error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;服务不可用&#39;</span>
                <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">504</span><span class="token operator">:</span>
                error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;网络超时&#39;</span>
                <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">505</span><span class="token operator">:</span>
                error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;http版本不支持该请求&#39;</span>
                <span class="token keyword">break</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">连接错误</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        error<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;连接到服务器失败&quot;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 将axios 的 post 方法，绑定到 vue 实例上面的 $post</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$post</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 将axios 的 get 方法，绑定到 vue 实例上面的 $get</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$get</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            params<span class="token operator">:</span> params
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token comment">// 返回请求成功的数据 data</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 请求示例</span>
<span class="token comment">// requestName 为多余的参数 作为请求的标识，下次发起相同的请求，就会自动取消上一次还没有结束的请求</span>
<span class="token comment">// 比如正常的请求参数只有一个 name: &#39;123&#39;，但是这里我们需要额外再加上一个 requestName</span>
<span class="token comment">/**
    this.$post(url, { name: &#39;123&#39;, requestName: &#39;post_1&#39; })
        .then(res =&gt; {
            console.log(`请求成功：${res}`)
        })
 */</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> axios
</code></pre></div><h3 id="main-js-中引入该文件"><a class="header-anchor" href="#main-js-中引入该文件" aria-hidden="true">#</a> main.js 中引入该文件</h3><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> axios <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./static/js/axiosTool&#39;</span>
</code></pre></div><h3 id="组件中直接使用即可"><a class="header-anchor" href="#组件中直接使用即可" aria-hidden="true">#</a> 组件中直接使用即可</h3><div class="language-js"><pre><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$post</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>url2<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;王&quot;</span><span class="token punctuation">,</span>
    docType<span class="token operator">:</span> <span class="token string">&quot;pson&quot;</span><span class="token punctuation">,</span>
    requestName<span class="token operator">:</span> <span class="token string">&#39;name02&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;李&quot;</span><span class="token punctuation">,</span>
    requestName<span class="token operator">:</span> <span class="token string">&#39;name01&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></div></div><footer class="page-footer" data-v-7c281d53 data-v-9b49b0ee><div class="edit" data-v-9b49b0ee><div class="edit-link" data-v-9b49b0ee data-v-6ddc3447><!----></div></div><div class="updated" data-v-9b49b0ee><!----></div></footer><!----><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"c96f0b0b\",\"readme.md\":\"1373c95d\",\"guide_axios.md\":\"3217e90e\",\"guide_book.md\":\"4f25a5b8\",\"guide_css.md\":\"b7564889\",\"guide_index.md\":\"2d5bae96\",\"guide_install.md\":\"f39fa479\",\"guide_jiexi.md\":\"bea2d9cf\",\"guide_kugou.md\":\"d2027f89\",\"guide_live.md\":\"6880526b\",\"guide_movie.md\":\"d55a7672\",\"guide_music.md\":\"065960c2\",\"guide_phpdl.md\":\"f947bc1e\",\"guide_plays.md\":\"ea641a25\",\"guide_tools.md\":\"7614b833\",\"guide_tv.md\":\"f0984e58\",\"guide_video.md\":\"07521741\",\"about_index.md\":\"61a4e2c7\",\"plugins_index.md\":\"0c037bf9\",\"source_byou.md\":\"1417d726\",\"source_free.md\":\"75ea1660\",\"source_migu.md\":\"aa91d389\",\"source_movie.md\":\"c4713ff8\",\"source_org.md\":\"a5c0764c\",\"source_qqyun.md\":\"19b62de6\",\"source_readme.md\":\"3e22ea87\",\"source_tools.md\":\"a0366ad5\",\"source_ttou.md\":\"fca14104\",\"source_xxx.md\":\"263a646d\",\"source_ygd.md\":\"5b72d86a\",\"template_index.md\":\"8051a6a5\",\"template_800cms_base.md\":\"456c54aa\",\"template_maccms_base.md\":\"19ce3c48\"}")</script>
    <script type="module" async src="/assets/app.6008987c.js"></script>
  </body>
</html>